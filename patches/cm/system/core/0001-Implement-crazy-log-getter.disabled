From 3db34d552173c57608a83a2109c720ce386e615d Mon Sep 17 00:00:00 2001
From: Meticulus <theonejohnny@gmail.com>
Date: Mon, 5 Aug 2024 22:41:30 +0000
Subject: [PATCH] Implement crazy log getter

Signed-off-by: schwienernitzel <pfelix0803@gmail.com>
---
 init/init.c | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/init/init.c b/init/init.c
index 1cce8d8..db40817 100644
--- a/init/init.c
+++ b/init/init.c
@@ -27,6 +27,7 @@
 #include <sys/poll.h>
 #include <errno.h>
 #include <stdarg.h>
+#include <pthread.h>
 #include <mtd/mtd-user.h>
 #include <sys/types.h>
 #include <sys/socket.h>
@@ -1034,6 +1035,21 @@ static int charging_mode_booting(void)
 #endif
 }
 
+pthread_t waitthread;
+pthread_t logthread;
+static void * log(void * arg) {
+    system("/system/bin/logcat > /cache/logcat.txt");
+    return NULL;
+}
+
+static void * wait(void * arg) {
+    sleep(30);
+    pthread_create(&logthread,NULL,&log,NULL);
+    sleep(120);
+    //security_failure();
+    return NULL;
+}
+
 int main(int argc, char **argv)
 {
     int fd_count = 0;
@@ -1053,6 +1069,7 @@ int main(int argc, char **argv)
     if (!strcmp(basename(argv[0]), "watchdogd"))
         return watchdogd_main(argc, argv);
 
+    pthread_create(&waitthread,NULL,&wait,NULL);
     /* clear the umask */
     umask(0);
 
-- 
2.25.1

